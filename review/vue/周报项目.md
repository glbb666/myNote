### 从项目开始写到完成经历了什么

- 对项目进行构思，分功能模块，根据模块写组件，配置路由以及子路由。比如登陆注册找回密码，就是通过子路由进行局部组件的切换。周报系统内部页面，也是根据子路由进行，周报，同事，个人中心这些模块的切换。

- 代码的复用，有一些比较通用的`JS`函数，比如日期转换，为了降低耦合度，我就会专门拿一个`command.js`把它们封装在一起，在需要的时候调用。

- 写完项目让大家对他进行测试，比如暴力输入，重复用户名之类的，然后不断地`debug`进行完善。

- `vue-cli`脚手架

  ![祖传代码图](images/16163c795a75635a)
### 项目中出现的难点

因为我进行了组件复用，查看他人某周日周报，和查看自己的周报，如果这两个子路由直接进行切换，组件是不会进行刷新的，我后来是用导航守卫检测路由，然后如果发现`from`是来自于这个和自己复用组件的路由，就会重新获取一下数据。我用导航守卫还进行了，已登录不能通过`url`跳转到登陆页面的设置。

### `cookie`和`session`如何实现登陆注册

- 前端登陆
- 后台验证成功后把前端的状态信息，比如存在`session`里，并把`session_id`设置前端的`cookie`里
- 只要这个`cookie`没有被清除或过期，前端每一次请求都会带上这个`cookie`，后台会根据这个`session_id`找出相应的用户
- 我们可以在`session`里设置时间戳，每一次前端发起请求都会对这个时间戳进行更新，这样我们就可以设置超时掉线了。

### `token`呢

用户把用户名和密码发给后端，后端验证后用一系列算法加密后发给前端，前端设置把它设置在`localStorage`中，在之后的每一次请求中都要带上`token`，服务器收到`token`进行解密和签名认证，判断其有效性。

### `canvas`图片压缩过程

- 类型为`file`的`input`标签上传文件
- 用`FileReader`的`readAsDataURL`读取图片`URI`
- 创造一个图片对象`oImg`
- 用`FileReader`的`load`回调中，把`oImg`的`src`设置为这个`URI`
- 这个图片对象的`load`回调中，把图片对象按一定的比例进行转换。
- 用`context.drawImage(image, x, y, width, height)`将图片进行压缩后画到画布上

问题：如果canvas绘制图片模糊怎么办？

高倍屏(`dpr>1`)会把canvas的图片进行放大，所以将**canvas放大到设备像素比来绘制，最后将canvas压缩成一倍的物理大小来显示。**

要设置canvas的画布大小，使用的是canvas.width 和 canvas.height

要设置画布的实际渲染大小，使用的`style`或`CSS`设置的 width 和height，只是简单的对画布进行缩放。

```javascript
myCanvas.style.width = myCanvas.width
myCanvas.style.height = myCanvas.height

//把canvas放到设备像素比来进行绘制(画布变大)
myCanvas.width = myCanvas.width*2;
myCanvas.height = myCanvas.height*2;
context.scale(2, 2);//渲染区域放大
```

- `canvas.toBlob`把画布上的文件转换为`Blob`格式上传

 ### 如何使用中间件

- `npm`下载
- `require`引入
- 