# 排查出需要优化的范围

1.埋点平台：埋点平台用户点击率前十的页面

2.平台监控工具 ：前端监控平台fcp时间前十的页面，且fcp需要大于500ms。（为什么需要500ms），因为服务端请求的平均响应时间差不多200ms-500ms。取500ms能确保在useEffect的时候数据已经在内存中了。fcp属于首页指标，具体定义见性能指标。

3.取并集：把这俩值取一个并集，就是需要优化的页面。

# 自定义打点

把需要优化的页面接入自定义打点，统计优化前的时间。

见自定义打点精确控制首屏时间

# 排查具体问题（性能卡点）

用performance平台，去抓取页面加载期间的火焰图。performance可以看性能优化工具，会详细说明。

- 如 JavaScript 执行、网络请求、绘制等。可以缩放和选择特定时间段来深入分析。
- 一般是选取比较长的时间短，或者内存占比比较高的时间短。去跳转到响应的代码。

抓包工具：

* 主要是看响应体的体积
* 有没有重复请求的情况，如果存在就存在重复渲染

包体积分析工具：可以跑出包大小。然后每个模块的占比。优先优化占比比较大的模块。一般是使用懒加载，图片优化等。

模块依赖分析工具：当优化模块的时候，需要评估对别的页面的影响。

## 优化实践

### 优化加载性能

**步骤：**

1. **HTTP请求优化：拍平，并行，prefetch**
2. **懒加载** ：仅在需要时才加载图像、视频和其他资源。
3. **代码分割** ：使用Webpack等工具按需加载代码。
4. 图片格式调整：svg，webp

### 优化运行时性能

**步骤：**

1. **使用性能优化模式** ：如React的PureComponent、memo、useMemo、useCallback等。

### 优化渲染性能

**步骤：**

1. **CSS优化** ：

* 避免使用复杂的CSS选择器，尽量使用简单、高效的选择器。
* 使用CSS动画而非JavaScript动画，CSS动画更高效。

2. **减少重绘和重排** ：尽量减少对DOM的频繁修改。
3. 节流和防抖，防止多次触发
4. **使用请求动画帧（requestAnimationFrame）** ：对于动画和滚动处理，使用requestAnimationFrame调度。

### 策略优化

- 业务通用解/海量点优化
- 降级策略：纹理渲染

### 最新技术

* **使用HTTP/2或HTTP/3** ：提升网络传输效率。
* SSR&SSG

### 持续监控和反馈

**步骤：**

1. **自动化测试** ：集成Lighthouse或其他性能测试工具到CI/CD流程中，持续监控性能。
2. **用户反馈平台、用户群**：收集用户反馈，监控真实用户的性能体验，及时调整优化策略。
3. **迭代优化**：观察不同的版本的页面表现。定期分析和优化，确保应用始终保持良好的性能。
