## 大致流程

1. 主进程：浏览器的主进程捕获URL，将URL请求发送到专门的网络进程。
2. 网络进程获取IP（详情见DNS解析）：网络进程查询 本地缓存=>host文件=>DNS服务器 获取URL对应的IP地址（如果输入的是IP地址，此步骤省略）
3. 网络进程根据IP建立TCP 连接：建立TCP 连接（三次握手），对于HTTPS连接，会额外执行SSL握手。
4. 网络进程通过建立的连接向服务器发起HTTP请求
5. 网络进程：服务器处理HTTP请求，浏览器接受响应，收集响应数据（HTML、图像、CSS、JavaScript等
6. 网络进程将收到的资源传递给浏览器的主进程
7. 主进程接着将这些数据发送给一个或多个渲染进程。
8. 渲染进程渲染
9. 关闭TCP连接（四次挥手）

## 一、DNS 解析获取对应IP

寻找ip的顺序

- 缓存中：浏览器缓存=>操作系统缓存=>路由器缓存，如果没有缓存或缓存已过期
- 本机的 `hosts`文件
- DNS服务器：如果**本地 DNS 服务器**没有缓存，需要采用递归或者迭代查询的方式依次向**根域名服务器**、**顶级域名服务器**、**权威域名服务器**发起查询请求

> DNS解析是很耗时的，因此如果解析域名过多，会让首屏加载变得过慢。
>
> DNS-prefetch会在后台预先解析页面上的域名，浏览器可以提前获取IP地址，从而减少请求资源时的延迟，加快页面的加载速度。
>
> 启用：`<link rel="dns-prefetch" href="//example.com">`。

## 二、根据IP建立TCP 连接（三次握手）

详情在网络安全/tcp的三次握手四次挥手

## 三、发起HTTP请求

浏览器会根据解析出的 `IP`地址+端口，构建HTTP请求报文，这个**请求报文**由三部分组成: **请求行**, **请求头**和**请求正文**，并将http请求封装在一个tcp包中，这个tcp包将依次经过**传输层，网络层，数据链路层，物理层**到达服务器。

#### 请求行

请求方法，请求地址，HTTP版本

常用的方法有: `GET`,` POST`, `PUT`,` DELETE`,` OPTIONS`, `HEAD`。

#### 请求头

请求报头允许客户端向服务器传递请求的**附加信息**和**客户端自身的信息**。

#### 请求体

当使用 `POST`, `PUT`等方法时，通常需要客户端向服务器传递数据。这些**数据就储存在请求体**中。在请求头中可以配置请求题的格式，例如: 有些接口会根据不同的数据格式接受不同的 `Content-Type`。具体见HTTP文件。

## 四、服务器接受HTTP请求，浏览器响应

服务器会解析这个请求并作出响应，返回相应的资源给浏览器。HTTP响应报文也是由三部分组成: **状态码**, **响应头**和**响应报文**。

#### 状态码

状态码是由3位数组成，第一个数字定义了响应的类别，且有五种可能取值:

- 1xx：指示信息–表示请求已接收，继续处理。
- 2xx：成功–表示请求已被成功接收、理解、接受。
- 3xx：重定向–要完成请求必须进行更进一步的操作。
- 4xx：客户端错误–请求有语法错误或请求无法实现。
- 5xx：服务器端错误–服务器未能实现合法的请求。
  平时遇到比较常见的状态码有:200, 204, 301, 302, 304, 400, 401, 403, 404, 422, 500(分别表示什么请自行查找)。

🌟301和302有什么区别？HTTP缓存？

#### 响应报头

常见的响应报头字段有: Server, Connection...。

#### 响应报文

服务器返回给浏览器的文本信息，通常 `HTML`, `CSS`,` JS`， 图片等文件就放在这一部分。

## 五、客户端渲染

详情在文档浏览器/浏览器的架构——渲染流程。

## 六、关闭TCP连接（四次挥手）

详情在网络安全/tcp的三次握手四次挥手
