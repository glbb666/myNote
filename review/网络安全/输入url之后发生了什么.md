## 大致流程

1. URL 解析
2. DNS 查询
3. TCP 连接
4. 服务器处理请求
5. 浏览器接受响应
6. 渲染页面

## 一、URL 解析

**地址解析：**

首先判断你输入的是一个合法的 URL 还是一个待搜索的关键词，并且根据你输入的内容进行自动补全、字符编码等操作。

**HSTS**

由于安全隐患，会使用 HSTS 强制客户端使用 HTTPS 访问页面。详见：[你所不知道的 HSTS](https://www.barretlee.com/blog/2015/10/22/hsts-intro/)。

**其他操作**

浏览器还会进行一些额外的操作，比如安全检查、访问限制（之前国产浏览器限制 996.icu）。

**检查缓存**

先检查本地有没有缓存，如果没有缓存则向服务器请求数据，如果有缓存，检查缓存有没有过期，如果缓存没有过期，就命中强缓存，如果缓存过期了，就携带标识向服务器发起请求，服务器会根据标识判断资源有没有被修改过，如果被修改了，就返回200和缓存标识和资源主题，否则返回304，让你使用本地缓存。

![img]([https://github.com/glbb666/myNote/blob/master/review/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image/cache2.png](https://github.com/glbb666/myNote/blob/master/review/网络安全/image/cache2.png))

## 二、DNS 解析

- 浏览器根据地址去本身缓存中查找dns解析记录，如果有，则直接返回IP地址，否则浏览器会查找操作系统中（hosts文件）是否有该域名的dns解析记录，如果有则返回。
- 如果浏览器缓存和操作系统hosts中均无该域名的dns解析记录，或者已经过期。就到你的路由器来查找，因为路由器一般也会有自己的 DNS 缓存。
- 若没有，则操作系统将域名发送至本地域名服务器（LDNS）——递归查询方式，本地域名服务器 查询自己的 DNS 缓存，查找成功则返回结果，否则，采用迭代查询方式。本地域名服务器一般都是你的网络接入服务器商提供，比如中国电信，中国移动。
- 本地域名服务器 将得到的 IP 地址返回给操作系统，同时自己也将 IP 地址缓存起来。
- 操作系统将 IP 地址返回给浏览器，同时自己也将 IP 地址缓存起来，以备下次别的用户查询时，可以直接返回结果，加快网络访问。
- 至此，浏览器已经得到了域名对应的 IP 地址。